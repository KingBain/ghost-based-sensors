---
name: Falco Count Test

on:
  workflow_dispatch:

jobs:
  foo:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      actions: read
    steps:
    - name: Start Falco
      uses: falcosecurity/falco-actions/start@e23d661998204b25988e4655899418e46924a68b
      with:
        mode: analyze
        
    - name: Count for 10 seconds
      run: |
        echo "Counting for 10 seconds…"
        for i in $(seq 1 10); do
          echo "  → $i"
          sleep 1
        done

    - name: Stop Falco
      uses: falcosecurity/falco-actions/stop@e23d661998204b25988e4655899418e46924a68b
      with:
        mode: analyze
  
  analyze-foo:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      actions: read
    steps:
    - name: Analyze
      uses: falcosecurity/falco-actions/analyze@e23d661998204b25988e4655899418e46924a68b
      with:
        falco-version: '0.39.0'